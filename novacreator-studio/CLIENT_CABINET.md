# Личный кабинет клиента и Push-уведомления

## Описание

Система личного кабинета позволяет клиентам отслеживать процесс разработки их проектов в реальном времени. Включает push-уведомления для мгновенных обновлений о прогрессе.

## Функционал

### Для клиентов:
- Регистрация и авторизация
- Просмотр всех своих проектов
- Отслеживание этапов разработки с визуальным прогрессом
- Просмотр заметок по каждому этапу
- Просмотр файлов проекта
- Push-уведомления о обновлениях

### Для администраторов:
- Управление проектами клиентов
- Изменение статуса и прогресса проектов
- Добавление заметок к этапам
- Автоматическая отправка push-уведомлений при обновлении

## Структура файлов

```
client/
├── config.php              # Конфигурация и функции
├── login.php              # Страница входа/регистрации
├── dashboard.php          # Личный кабинет клиента
├── logout.php             # Выход из системы
├── save-subscription.php  # Сохранение push-подписки
├── check-subscription.php # Проверка подписки
└── send-notification.php  # Отправка уведомлений

admin/
├── projects.php           # Список проектов
└── project-form.php       # Форма создания/редактирования

data/
├── users.json             # Пользователи
├── projects.json          # Проекты
└── push_subscriptions.json # Push-подписки

sw.js                      # Service Worker для уведомлений
```

## Этапы разработки проекта

1. **Планирование** - Анализ требований и составление ТЗ
2. **Дизайн** - Создание макетов и прототипов
3. **Разработка** - Программирование и верстка
4. **Тестирование** - Проверка функциональности
5. **Деплой** - Размещение на хостинге
6. **SEO-оптимизация** - Настройка для поисковиков
7. **Завершено** - Проект готов

## Настройка Push-уведомлений

### 1. VAPID ключи уже настроены

Ключи уже добавлены в код:
- **Public Key**: `BAu829izfGzXhqCafmsCdylgoMCqYTKVdzJSIft7orDyAYBxk0VenPv2GOuyxISF3AaleH8Qb3AokrhwHN4Ecg0`
- **Private Key**: `utERA94z2T_VBXuAeUO1oVUWngAuuOpaCKrlnpDt9-M`

### 2. Установка библиотеки web-push (рекомендуется)

Для правильной работы push-уведомлений установите библиотеку через Composer:

```bash
cd novacreator-studio
composer install
```

Это установит библиотеку `minishlink/web-push`, которая обеспечит корректную отправку уведомлений.

### 3. Альтернатива без Composer

Если Composer недоступен, система будет использовать упрощенную реализацию в `client/send-notification.php`. 
Однако для продакшена рекомендуется использовать библиотеку web-push.

### 4. Проверка работы

1. Убедитесь, что сайт работает по HTTPS (обязательно для push-уведомлений)
2. Зарегистрируйтесь в личном кабинете
3. Включите уведомления в дашборде
4. Обновите проект в админ-панели - клиент должен получить уведомление

## Использование

### Для клиентов:

1. Перейдите на `/client/login.php`
2. Зарегистрируйтесь или войдите
3. Просматривайте свои проекты в личном кабинете
4. Включите push-уведомления для получения обновлений

### Для администраторов:

1. Войдите в админ-панель блога
2. Перейдите в раздел "Проекты"
3. Создайте новый проект или отредактируйте существующий
4. Измените статус, прогресс и добавьте заметки
5. При сохранении клиент автоматически получит push-уведомление

## Автоматическое создание проектов

При отправке заявки через форму контактов (`/contact`):
- Если пользователь с таким email существует - проект привязывается к нему
- Если пользователя нет - создается новый пользователь и проект автоматически

## Права доступа к файлам

Убедитесь, что файлы данных имеют правильные права:

```bash
chmod 755 data/
chmod 666 data/*.json
```

## Безопасность

- Пароли хранятся с использованием `password_hash()`
- Сессии используются для авторизации
- Валидация всех входных данных
- Защита от SQL-инъекций (используется JSON вместо БД)

## Интеграция с существующими формами

Система автоматически интегрирована с формой обратной связи (`/backend/send.php`). При отправке заявки с указанием услуги автоматически создается проект.

## Поддержка браузеров

Push-уведомления работают в:
- Chrome/Edge (Windows, Android)
- Firefox (Windows, Android)
- Safari (macOS, iOS) - требует дополнительной настройки
- Opera

## Troubleshooting

### Push-уведомления не работают:
1. Проверьте, что Service Worker зарегистрирован (консоль браузера)
2. Убедитесь, что VAPID ключи настроены правильно
3. Проверьте права доступа к файлам данных
4. Убедитесь, что сайт работает по HTTPS (обязательно для push)

### Проекты не отображаются:
1. Проверьте права доступа к `data/projects.json`
2. Убедитесь, что клиент авторизован
3. Проверьте, что `client_id` совпадает с ID пользователя

### Ошибки при сохранении:
1. Проверьте права записи в папку `data/`
2. Убедитесь, что JSON файлы не повреждены
3. Проверьте логи ошибок PHP

