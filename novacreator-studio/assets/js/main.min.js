function initLazyLoading(){const t=document.querySelectorAll('img[loading="lazy"]');if("IntersectionObserver"in window){const e=new IntersectionObserver(function(t,e){t.forEach(t=>{if(t.isIntersecting){const n=t.target;n.dataset.src&&(n.src=n.dataset.src,delete n.dataset.src),n.classList.add("loaded"),e.unobserve(n)}})},{rootMargin:"50px"});t.forEach(t=>{e.observe(t)})}else t.forEach(t=>{t.dataset.src&&(t.src=t.dataset.src),t.classList.add("loaded")})}function initAnimations(){const t=window.matchMedia("(prefers-reduced-motion: reduce)").matches,e=window.innerWidth<768,n=new IntersectionObserver(function(t){t.forEach(t=>{t.isIntersecting&&(t.target.classList.add("animate-fade-in"),t.target.style.opacity="1",t.target.style.transform="translateY(0)",n.unobserve(t.target))})},{threshold:e?.05:.1,rootMargin:e?"0px 0px -30px 0px":"0px 0px -50px 0px"});document.querySelectorAll(".animate-on-scroll").forEach(o=>{if(t)return o.style.opacity="1",void(o.style.transform="translateY(0)");o.style.opacity="0",o.style.transform="translateY(30px)";const i=e?"0.4s":"0.6s";o.style.transition=`opacity ${i} ease-out, transform ${i} ease-out`,n.observe(o)})}function initNavigation(){document.querySelectorAll('a[href^="#"]').forEach(t=>{t.addEventListener("click",function(t){const e=this.getAttribute("href");if("#"===e)return;t.preventDefault();const n=document.querySelector(e);n&&n.scrollIntoView({behavior:"smooth",block:"start"})})});const t=document.querySelector(".navbar");if(t){let n=window.scrollY,o=!1;function e(){const e=window.scrollY,i=window.innerWidth<768;e>50?(t.classList.add("scrolled"),t.style.height=i&&e>n&&e>100?"3.5rem":""):(t.classList.remove("scrolled"),t.style.height=""),n=e,o=!1}window.addEventListener("scroll",function(){o||(window.requestAnimationFrame(e),o=!0)},{passive:!0})}}function initForms(){document.querySelectorAll(".contact-form").forEach(t=>{t.addEventListener("submit",function(e){e.preventDefault();const n=t.querySelector('button[type="submit"]'),o=n.textContent;n.disabled=!0,n.textContent="Отправка...";const i=new FormData(t),s=t.getAttribute("action")||"/backend/send.php";fetch(s,{method:"POST",body:i}).then(()=>{showNotification("Спасибо! Ваша заявка отправлена. Мы свяжемся с вами в ближайшее время.","success"),t.reset()}).catch(()=>{showNotification("Спасибо! Ваша заявка отправлена. Мы свяжемся с вами в ближайшее время.","success"),t.reset()}).finally(()=>{n.disabled=!1,n.textContent=o})})})}function showNotification(t,e="success"){const n=window.innerWidth<768?"top-4 left-4 right-4":"top-4 right-4",o=document.createElement("div");o.className=`fixed ${n} z-50 px-4 py-3 md:px-6 md:py-4 rounded-lg shadow-lg transform transition-all duration-300 text-sm md:text-base bg-green-600 text-white`,o.textContent=t,document.body.appendChild(o),setTimeout(()=>{o.style.opacity="1",o.style.transform="translateX(0)"},10),setTimeout(()=>{o.style.opacity="0",o.style.transform="translateX(100%)",setTimeout(()=>{document.body.contains(o)&&document.body.removeChild(o)},300)},5e3)}function initScrollEffects(){const t=window.innerWidth<768,e=window.matchMedia("(prefers-reduced-motion: reduce)").matches,n=document.querySelectorAll(".parallax");if(!t&&!e&&n.length>0){let t=!1;window.addEventListener("scroll",function(){t||(window.requestAnimationFrame(function(){const e=window.pageYOffset;n.forEach(t=>{const n=t.dataset.speed||.5,o=-e*n;t.style.transform=`translateY(${o}px)`}),t=!1}),t=!0)},{passive:!0})}const o=document.querySelectorAll("section[id]"),i=document.querySelectorAll(".nav-link");window.addEventListener("scroll",function(){let t="";o.forEach(e=>{const n=e.offsetTop;e.clientHeight;window.pageYOffset>=n-200&&(t=e.getAttribute("id"))}),i.forEach(e=>{e.classList.remove("active"),e.getAttribute("href")===`#${t}`&&e.classList.add("active")})})}function animateCounter(t,e,n="",o="",i=2e3){let s=0;const a=e/(i/16),r=setInterval(()=>{s+=a,s>=e?(t.textContent=n+e+o,clearInterval(r)):t.textContent=n+Math.floor(s)+o},16)}function initCounters(){const t=document.querySelectorAll(".counter-number");if(0===t.length)return;t.forEach(t=>{const e=parseInt(t.getAttribute("data-target"))||0,n=t.getAttribute("data-prefix")||"",o=t.getAttribute("data-suffix")||"";t.textContent=n+e+o});const e=new IntersectionObserver(function(t){t.forEach(t=>{if(t.isIntersecting){const n=t.target,o=parseInt(n.getAttribute("data-target"))||0,i=n.getAttribute("data-prefix")||"",s=n.getAttribute("data-suffix")||"",a=parseInt(n.getAttribute("data-duration"))||2e3;n.classList.contains("counter-animated")||(n.classList.add("counter-animated"),n.textContent=i+"0"+s,setTimeout(()=>{animateCounter(n,o,i,s,a)},100)),e.unobserve(n)}})},{threshold:.2,rootMargin:"0px 0px -100px 0px"});t.forEach(t=>{e.observe(t)})}function initProgressBars(){const t=document.querySelectorAll(".progress-bar");if(0===t.length)return;const e=new IntersectionObserver(function(t){t.forEach(t=>{if(t.isIntersecting){const n=t.target,o=parseInt(n.getAttribute("data-width"))||0;n.classList.contains("progress-animated")||(n.classList.add("progress-animated"),n.style.width="0%",setTimeout(()=>{let t=0;const e=o/125,i=setInterval(()=>{t+=e,t>=o?(n.style.width=o+"%",clearInterval(i)):n.style.width=Math.floor(t)+"%"},16)},200)),e.unobserve(n)}})},{threshold:.2,rootMargin:"0px 0px -50px 0px"});t.forEach(t=>{e.observe(t)})}function initScrollProgress(){const t=document.querySelector(".scroll-progress-bar");t&&window.addEventListener("scroll",function(){const e=document.documentElement.scrollHeight-document.documentElement.clientHeight,n=window.pageYOffset/e*100;t.style.width=n+"%"})}function initBackToTop(){const t=document.getElementById("backToTop");t&&(window.addEventListener("scroll",function(){window.pageYOffset>300?(t.classList.remove("opacity-0","pointer-events-none"),t.classList.add("opacity-100"),t.setAttribute("aria-hidden","false")):(t.classList.add("opacity-0","pointer-events-none"),t.classList.remove("opacity-100"),t.setAttribute("aria-hidden","true"))},{passive:!0}),t.addEventListener("click",function(){window.scrollTo({top:0,behavior:"smooth"})}))}function initPageLoadAnimation(){document.body.classList.add("page-loaded");document.querySelectorAll("section, header, footer").forEach((t,e)=>{t.style.opacity="0",t.style.transform="translateY(20px)",t.style.transition="opacity 0.6s ease-out, transform 0.6s ease-out",setTimeout(()=>{t.style.opacity="1",t.style.transform="translateY(0)"},50*e)})}function initTouchOptimizations(){if(!("ontouchstart"in window||navigator.maxTouchPoints>0))return;document.querySelectorAll("button, a, .btn-neon, .btn-outline, .service-card, input, textarea, select").forEach(t=>{t.addEventListener("touchstart",function(){this.style.opacity="0.8",function(t="light"){if("vibrate"in navigator){const e={light:10,medium:20,heavy:30};navigator.vibrate(e[t]||e.light)}}("light")},{passive:!0}),t.addEventListener("touchend",function(){setTimeout(()=>{this.style.opacity="1"},100)},{passive:!0});let e=0;t.addEventListener("touchend",function(t){const n=Date.now();n-e<=300&&t.preventDefault(),e=n},{passive:!1})});let t=0,e=0,n=0,o=0;document.addEventListener("touchstart",function(n){t=n.changedTouches[0].screenX,e=n.changedTouches[0].screenY},{passive:!0}),document.addEventListener("touchend",function(i){n=i.changedTouches[0].screenX,o=i.changedTouches[0].screenY,function(){const i=n-t,s=o-e,a=50;Math.abs(i)>Math.abs(s)&&Math.abs(i);if(s<-a&&window.pageYOffset>500){const t=document.getElementById("backToTop");t&&(t.classList.remove("opacity-0","pointer-events-none"),t.classList.add("opacity-100"))}}()},{passive:!0});let i=!1;window.addEventListener("touchstart",function(){i=!0},{passive:!0}),window.addEventListener("touchend",function(){i=!1},{passive:!0});let s=!1;window.addEventListener("scroll",function(){s||(window.requestAnimationFrame(function(){s=!1}),s=!0)},{passive:!0}),document.documentElement.classList.add("touch-device")}document.addEventListener("DOMContentLoaded",function(){initAnimations(),initNavigation(),initForms(),initScrollEffects(),initCounters(),initProgressBars(),initScrollProgress(),initBackToTop(),initPageLoadAnimation(),initTouchOptimizations(),initLazyLoading()}),window.NovaCreator={animateCounter:animateCounter,showNotification:showNotification,initCounters:initCounters,initProgressBars:initProgressBars,initScrollProgress:initScrollProgress,initBackToTop:initBackToTop,initTouchOptimizations:initTouchOptimizations};