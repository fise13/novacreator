# Настройка Telegram бота

## Инструкция по настройке

### 1. Создание бота

1. Откройте Telegram и найдите бота [@BotFather](https://t.me/BotFather)
2. Отправьте команду `/newbot`
3. Следуйте инструкциям и создайте бота
4. Сохраните токен бота (выглядит как `123456789:ABCdefGHIjklMNOpqrsTUVwxyz`)

### 2. Получение Chat ID группы

#### Вариант 1: Через бота @getidsbot
1. Добавьте бота [@getidsbot](https://t.me/getidsbot) в вашу группу
2. Отправьте любое сообщение в группу
3. Бот ответит с Chat ID группы (будет отрицательным числом, например: `-1001234567890`)

#### Вариант 2: Через API Telegram
1. Добавьте вашего бота в группу
2. Отправьте любое сообщение в группу от имени бота или любого пользователя
3. Откройте в браузере: `https://api.telegram.org/botВАШ_ТОКЕН/getUpdates`
4. Найдите в ответе `"chat":{"id":-1001234567890}` - это и есть Chat ID группы

#### Вариант 3: Через бота @RawDataBot
1. Добавьте бота [@RawDataBot](https://t.me/RawDataBot) в группу
2. Бот покажет всю информацию о группе, включая Chat ID

### 3. Настройка config.php

1. Скопируйте `config.example.php` в `config.php`:
   ```bash
   cp config.example.php config.php
   ```

2. Откройте `config.php` и заполните:
   ```php
   define('TELEGRAM_BOT_TOKEN', 'ваш_токен_от_BotFather');
   define('TELEGRAM_CHAT_ID', '-1001234567890'); // Chat ID группы (с минусом!)
   define('TELEGRAM_ENABLED', true);
   ```

### 4. Проверка работы

1. Откройте в браузере: `telegram_bot/test_send.php`
2. Или запустите через командную строку:
   ```bash
   php telegram_bot/test_send.php
   ```
3. Если всё настроено правильно, вы увидите сообщение в группе Telegram

## Частые проблемы

### Сообщения не приходят в группу

1. **Бот не добавлен в группу**
   - Убедитесь, что бот добавлен в группу как участник
   - Бот должен быть в списке участников группы

2. **Неправильный Chat ID**
   - Для групп Chat ID должен быть отрицательным числом (начинаться с минуса)
   - Убедитесь, что вы используете Chat ID группы, а не личного чата

3. **Бот не может отправлять сообщения**
   - Бот должен иметь возможность отправлять сообщения в группу
   - Если группа имеет ограничения, убедитесь, что бот может писать

4. **Проверьте логи**
   - Ошибки логируются в `backend/telegram_errors.log`
   - Проверьте файл на наличие ошибок

### Как проверить, что бот работает

1. Отправьте боту личное сообщение (не в группу)
2. Если бот отвечает, значит токен правильный
3. Затем добавьте бота в группу и проверьте отправку через `test_send.php`

## Безопасность

⚠️ **ВАЖНО**: 
- Никогда не публикуйте `config.php` в публичных репозиториях
- Файл `config.php` уже добавлен в `.gitignore`
- Токен бота дает полный доступ к боту - храните его в секрете

