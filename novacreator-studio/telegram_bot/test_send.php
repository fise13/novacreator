<?php
/**
 * –¢–µ—Å—Ç–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π –≤ Telegram
 * 
 * –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ: –æ—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ telegram_bot/test_send.php
 * –ò–ª–∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ —á–µ—Ä–µ–∑ –∫–æ–º–∞–Ω–¥–Ω—É—é —Å—Ç—Ä–æ–∫—É: php telegram_bot/test_send.php
 */

// –ü–æ–¥–∫–ª—é—á–∞–µ–º –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Ñ–∞–π–ª—ã
require_once __DIR__ . '/config.php';
require_once __DIR__ . '/send_telegram.php';

echo "=== –¢–µ—Å—Ç –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è –≤ Telegram ===\n\n";

// –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
echo "1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:\n";
echo "   TELEGRAM_ENABLED: " . (TELEGRAM_ENABLED ? '–î–ê' : '–ù–ï–¢') . "\n";
echo "   TELEGRAM_BOT_TOKEN: " . (TELEGRAM_BOT_TOKEN !== 'YOUR_BOT_TOKEN_HERE' ? '–ù–∞—Å—Ç—Ä–æ–µ–Ω (' . substr(TELEGRAM_BOT_TOKEN, 0, 10) . '...)' : '–ù–ï –ù–ê–°–¢–†–û–ï–ù') . "\n";
echo "   TELEGRAM_CHAT_ID: " . TELEGRAM_CHAT_ID . "\n\n";

if (!TELEGRAM_ENABLED) {
    echo "‚ùå –û–¢–ü–†–ê–í–ö–ê –û–¢–ö–õ–Æ–ß–ï–ù–ê –í –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–ò\n";
    exit;
}

if (TELEGRAM_BOT_TOKEN === 'YOUR_BOT_TOKEN_HERE' || TELEGRAM_CHAT_ID === 'YOUR_CHAT_ID_HERE') {
    echo "‚ùå –¢–û–ö–ï–ù –ò–õ–ò CHAT ID –ù–ï –ù–ê–°–¢–†–û–ï–ù–´\n";
    exit;
}

// –¢–µ—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
$testMessage = "üß™ <b>–¢–µ—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ</b>\n\n";
$testMessage .= "–≠—Ç–æ —Ç–µ—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞–±–æ—Ç—ã Telegram –±–æ—Ç–∞.\n";
$testMessage .= "–ï—Å–ª–∏ –≤—ã –≤–∏–¥–∏—Ç–µ —ç—Ç–æ —Å–æ–æ–±—â–µ–Ω–∏–µ, –∑–Ω–∞—á–∏—Ç –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ!\n\n";
$testMessage .= "–í—Ä–µ–º—è –æ—Ç–ø—Ä–∞–≤–∫–∏: " . date('Y-m-d H:i:s');

echo "2. –û—Ç–ø—Ä–∞–≤–∫–∞ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è...\n";
$result = sendTelegramMessage($testMessage, 'contact');

echo "\n3. –†–µ–∑—É–ª—å—Ç–∞—Ç:\n";
if ($result['success']) {
    echo "‚úÖ –£–°–ü–ï–•: " . $result['message'] . "\n";
    echo "\n–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≥—Ä—É–ø–ø—É –≤ Telegram - —Å–æ–æ–±—â–µ–Ω–∏–µ –¥–æ–ª–∂–Ω–æ –ø—Ä–∏–π—Ç–∏.\n";
} else {
    echo "‚ùå –û–®–ò–ë–ö–ê: " . $result['message'] . "\n";
    echo "\n–í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã:\n";
    echo "- –ë–æ—Ç –Ω–µ –¥–æ–±–∞–≤–ª–µ–Ω –≤ –≥—Ä—É–ø–ø—É\n";
    echo "- –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π Chat ID –≥—Ä—É–ø–ø—ã\n";
    echo "- –ë–æ—Ç –Ω–µ –∏–º–µ–µ—Ç –ø—Ä–∞–≤ –Ω–∞ –æ—Ç–ø—Ä–∞–≤–∫—É —Å–æ–æ–±—â–µ–Ω–∏–π\n";
    echo "- –ü—Ä–æ–±–ª–µ–º—ã —Å –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ–º\n";
    echo "\n–ü—Ä–æ–≤–µ—Ä—å—Ç–µ:\n";
    echo "1. –î–æ–±–∞–≤–ª–µ–Ω –ª–∏ –±–æ—Ç –≤ –≥—Ä—É–ø–ø—É\n";
    echo "2. –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –ª–∏ Chat ID –≥—Ä—É–ø–ø—ã (–¥–æ–ª–∂–µ–Ω –Ω–∞—á–∏–Ω–∞—Ç—å—Å—è —Å –º–∏–Ω—É—Å–∞ –¥–ª—è –≥—Ä—É–ø–ø)\n";
    echo "3. –ú–æ–∂–µ—Ç –ª–∏ –±–æ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è (–ø—Ä–∞–≤–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –Ω–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã, –Ω–æ –±–æ—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤ –≥—Ä—É–ø–ø–µ)\n";
}

echo "\n=== –ö–æ–Ω–µ—Ü —Ç–µ—Å—Ç–∞ ===\n";

